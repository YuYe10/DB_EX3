# 学生选课与成绩管理系统 - 启动指南

## ✅ 系统已完成实现

### 📁 项目结构
```
backend/
  ├── app.py          # Flask API服务（含认证、权限控制）
  ├── db.py           # 数据库连接和schema（含users表）
  └── main.py
frontend/vue/src/
  ├── App.vue         # 主路由控制器
  └── components/
      ├── Login.vue       # 登录界面
      ├── StudentView.vue # 学生界面
      ├── TeacherView.vue # 教师界面
      └── AdminView.vue   # 管理员界面
```

### 🚀 启动步骤

#### 1. 启动后端
```powershell
cd backend
python app.py
```

**如果遇到模块未安装错误：**
```powershell
pip install flask flask-cors flask-session python-dotenv psycopg2-binary
```

后端将运行在 `http://localhost:5000`

#### 2. 启动前端
```powershell
cd frontend/vue
npm install   # 首次运行
npm run dev
```

前端将运行在 `http://localhost:5173`（或其他端口）

### 🔐 登录账号

#### 管理员
- 账号: `admin`
- 密码: `admin@123`

#### 学生
- 账号: 学号（如 `S001`）
- 密码: `s` + 学号（如 `sS001`）

#### 教师
- 账号: 工号（如 `T001`）
- 密码: `t` + 工号（如 `tT001`）

**注意：** 
- 学生和教师账号在管理员创建学生/教师时自动生成
- 所有用户均可在登录后修改密码

### 🎯 功能清单

#### 学生界面 ✅
- ✅ 查看可选课程列表
- ✅ 选课操作
- ✅ 退课操作
- ✅ 查看已选课程和成绩
- ✅ 修改密码

#### 教师界面 ✅
- ✅ 查看授课课程列表
- ✅ 查看每门课程的学生名单
- ✅ 录入和修改学生成绩
- ✅ 修改密码

#### 管理员界面 ✅
- ✅ 管理学生（CRUD）
- ✅ 管理教师（CRUD）
- ✅ 管理课程（CRUD）
- ✅ 管理选课记录（CRUD）
- ✅ 批量录入成绩
- ✅ 查看统计数据（学生/教师/课程/选课数量）
- ✅ 查看课程平均成绩

### 🗄️ 数据库表结构

```sql
-- 学生表
students (id, student_no, name, major)

-- 教师表
teachers (id, teacher_no, name, department)

-- 课程表
courses (id, course_code, name, credit, capacity, teacher_id)

-- 选课表
enrollments (id, student_id, course_id, status, grade, enrolled_at)

-- 用户表（新增）
users (id, username, password, role, ref_id, created_at)
```

### 🔒 权限控制

- **学生**: 只能选课/退课/查看自己的选课
- **教师**: 只能查看和管理自己授课的课程及学生成绩
- **管理员**: 完整的CRUD权限

所有API都使用Flask-Session进行身份验证和权限检查。

### 🎨 界面特性

- ✨ 渐变动画背景
- 📱 响应式设计（支持手机/平板/桌面）
- 🎭 玻璃态毛玻璃效果
- 🔄 平滑动画和过渡
- 💫 现代化UI设计

### 📝 环境配置

确保 `.env` 文件配置正确：

```env
OG_HOST=127.0.0.1
OG_PORT=26000
OG_DBNAME=student_db
OG_USER=appuser
OG_PASSWORD=your_password
OG_SSH_TUNNEL=false
SECRET_KEY=your-secret-key-change-in-production
```

### ⚠️ 常见问题

1. **后端启动失败 - ModuleNotFoundError**
   - 运行: `pip install -r requirements.txt`

2. **前端无法连接后端**
   - 检查后端是否运行在 `http://localhost:5000`
   - 检查CORS配置

3. **数据库连接失败**
   - 确认openGauss服务运行正常
   - 检查 `.env` 配置
   - 确认用户appuser有足够权限

4. **用户登录失败**
   - 管理员账号需要手动在数据库初始化时创建
   - 学生/教师账号在创建数据时自动生成

### 🎉 开始使用

1. 启动后端和前端
2. 浏览器打开前端地址
3. 使用管理员账号登录
4. 创建学生、教师、课程
5. 切换到学生/教师账号测试功能

---

**开发完成日期**: 2025年12月11日
**技术栈**: Vue 3 + Flask + openGauss + Flask-Session
